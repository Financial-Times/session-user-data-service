
<!DOCTYPE html>
<html>
<head>
	<title>Session user data service</title>
	<meta charset="utf-8" />

	<link rel="stylesheet" href="//build.origami.ft.com/bundles/css?modules=o-techdocs@4.0.4" />
	<script src="//build.origami.ft.com/bundles/js?modules=o-techdocs@4.0.4"></script>
</head>
<body>
	<header data-o-component="o-header" class="o-header">
		<div class="o-header__container">
			<div class="o-header__inner">
				<div class="o-header__primary">
					<div class="o-header__primary__left">
						<a class="o-header__logo o-header__logo--ft" href="http://www.ft.com">
							<abbr title="Financial Times">FT</abbr>
							<h1 class="o-header__title">Session user data service</h1>
						</a>
					</div>
				</div>
			</div>
		</div>
	</header>


	<!-- Navigation menu and main content -->
	<div class="o-techdocs-layout">
		<!-- Main content (outer div for layout, inner for formatting) -->
		<div class="o-techdocs-main">
			<div class="o-techdocs-content">
				<h1>Description</h1>
				<p class="o-techdocs-leadbody">A webservice used for validating user's session, generating web tokens for initializing the LiveFyre widget and authenticating the user and retrieving user data for refreshing it in livefyre.</p>

				<h2 id="headings">Technical details</h2>
				<h3>Platform</h3>
				<p>The application is a Node.js app.</p>

				<hr>

				<h3>Storage</h3>
				<p>MongoDB is used to persist the data about the users, articles and sessions.</p>

				<hr>

				<h3>API</h3>
				<small><em>Parameters marked with * are required.</em></small>

				<p><code>GET /v1/livefyre/metadata</code></p>
				<div class="o-techdocs-table-wrapper">
					<table style="width: 100%">
						<tbody>
							<tr>
								<th>Param</th>
								<th>Description</th>
							</tr>
							<tr>
								<td><var>articleId</var> *</td>
								<td>
									Id of the article
								</td>
							</tr>
							<tr>
								<td><var>url</var> *</td>
								<td>
									URL of the article
								</td>
							</tr>
						</tbody>
					</table>
				</div>

				<h4>Returns</h4>
				<p>CAPI tags (sections, authors, brand) based on article ID, and URL tags based on the URL (for alphaville, blogs, discussion and lexicon URLs)</p>



				<p><code>GET /v1/livefyre/getcollectiondetails</code></p>
				<div class="o-techdocs-table-wrapper">
					<table style="width: 100%">
						<tbody>
							<tr>
								<th>Param</th>
								<th>Description</th>
							</tr>
							<tr>
								<td><var>articleId</var> *</td>
								<td>
									Id of the article
								</td>
							</tr>
							<tr>
								<td><var>url</var> *</td>
								<td>
									URL of the article
								</td>
							</tr>
							<tr>
								<td><var>title</var> *</td>
								<td>
									Title of the article
								</td>
							</tr>
							<tr>
								<td><var>sessionId</var></td>
								<td>
									Session ID of the user
								</td>
							</tr>

							<tr>
								<td><var>stream_type</var></td>
								<td>
									Can be one of 'livecomments', 'liveblog', 'livechat'. Default is 'livecomments'
								</td>
							</tr>
							<tr>
								<td><var>tags</var></td>
								<td>
									Custom tags to be added to the default list of CAPI and URL tags
								</td>
							</tr>
						</tbody>
					</table>
				</div>

				<h4>Returns</h4>
				<p>
					<ul>
						<li>siteId</li>
						<li>articleId</li>
						<li>collectionMeta</li>
						<li>checksum</li>
						<li>notAllowedToCreateCollection: if this flag is true, that means that the collection is not created and the current user does not have permission to create the collection.</li>
					</ul>
				</p>
			</div> <!-- /o-techdocs-content -->
		</div>
	</div> <!-- /row containing nav and content -->

	<footer class="o-techdocs-footer">
		<div class="o-techdocs-footer__inner">
			<p class="o-techdocs-footer__secondary"><a href="http://github.com/financial-times/ft-origami">View project on GitHub</a></p>
			<p>&#xA9; THE FINANCIAL TIMES LTD. FT and 'Financial Times' are trademarks of The Financial Times Ltd.</p>
		</div>
	</footer>
</body>
</html>
